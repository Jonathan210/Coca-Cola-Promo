<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coca-Cola | The Experience</title>
    <link rel="icon" href="assets/logo-4.png" type="image/x-icon" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div id="custom-cursor"></div>
    <div id="transition-overlay"></div>

    <nav class="navbar">
        <img src="assets/logo-4.png" alt="Coca-Cola Logo" class="logo-img">
        <div class="nav-links">
            <a href="#welcome-section" class="active">WELCOME</a>
            <a href="#product-section">PRODUCTS</a>
            <a href="#about-section">ABOUT</a>
            <a href="#contact-section">CONTACT</a>
        </div>
    </nav>

    <section id="welcome-section" class="main-section">
        <video autoplay loop playsinline id="welcome-video">
            <source src="assets/Welcome.mp4" type="video/mp4">
        </video>
        <div class="welcome-content">
            <h1 id="site-title" class="animated-element fade-in-up">The Refreshing Experience</h1>
            <p class="animated-element fade-in-up" style="transition-delay: 0.2s;">Discover the taste of the world's
                favorite drink.</p>
            <a href="#product-section" class="enter-btn animated-element fade-in-up" style="transition-delay: 0.4s;"
                id="start-experience-btn">Start Experience</a>
        </div>
    </section>

    <section id="product-section" class="main-section">
        <video autoplay muted loop playsinline id="product-video-bg">
            <source src="assets/Product.mp4" type="video/mp4">
        </video>
        <div class="hero-content" id="product-hero-content">
            <div class="hero-text text-active" id="slideshow-text-content">
                <span style="font-size: 0.9em; letter-spacing: 2px; font-weight: 600;" id="product-tag">THE
                    ORIGINAL</span>
                <h1 class="headline" id="headline">ORIGINAL TASTE</h1>
                <p id="description" style="margin-bottom: 20px; line-height: 1.6;">The world's most popular soft drink.
                </p>
                <a href="#" class="enter-btn" id="drink-now-btn"
                    style="background: transparent; border: 1px solid white;">View Facts</a>
            </div>
            <button id="toggle-view-btn" class="enter-btn">View All Products</button>
        </div>

        <div class="hero-section-scroll" id="hero-scroll-container">
            <div class="carousel-inner" id="carousel-inner">
            </div>
        </div>

        <div class="left-pagination">
            <span id="current-slide">01</span> / <span id="total-slides">14</span>
        </div>
        <div class="nav-arrows">
            <button class="arrow-btn" id="prev-btn"><i class="fas fa-chevron-left"></i></button>
            <button class="arrow-btn" id="next-btn"><i class="fas fa-chevron-right"></i></button>
        </div>
    </section>

    <section id="about-section" class="main-section">
        <video autoplay muted loop playsinline id="product-video-bg">
            <source src="assets/About.mp4" type="video/mp4">
        </video>
        <div class="about-container">
            <div class="about-text">
                <h2 class="animated-element fade-in-up">A Global Icon & Purpose</h2>
                <p class="animated-element fade-in-up" style="transition-delay: 0.2s;">The Coca-Cola Company (NYSE: KO)
                    is a total beverage company with products sold in more than 200 countries and territories. Our
                    companyâ€™s purpose is to refresh the world and make a difference.</p>

                <h3 class="animated-element fade-in-up" style="transition-delay: 0.4s;">Our Enduring Legacy</h3>
                <p class="animated-element fade-in-up" style="transition-delay: 0.6s;">Invented in 1886 by Dr. John
                    Stith Pemberton in Atlanta, Georgia, Coca-Cola was first offered as a fountain beverage at Jacob's
                    Pharmacy. It quickly grew into a cultural phenomenon. Today, Coca-Cola is one of the world's most
                    recognized and valuable brands, transcending its role as a simple beverage to become a symbol of
                    shared moments and optimism worldwide.</p>

                <h3 class="animated-element fade-in-up" style="transition-delay: 0.8s;">Commitment to Sustainability
                </h3>
                <p class="animated-element fade-in-up" style="transition-delay: 1.0s;">We are dedicated to building a
                    sustainable future by focusing on water stewardship, circular economy for packaging, and reducing
                    our carbon footprint across the value chain.</p>
            </div>
            <div class="about-stats animated-element fade-in-up" style="transition-delay: 1.2s;">
                <div class="stat-box">
                    <span class="stat-number">135+</span>
                    <span class="stat-label">Years of Refreshment</span>
                </div>
                <div class="stat-box">
                    <span class="stat-number">200+</span>
                    <span class="stat-label">Countries with Coca-Cola</span>
                </div>
                <div class="stat-box">
                    <span class="stat-number">400+</span>
                    <span class="stat-label">Total Brands Worldwide</span>
                </div>
                <div class="stat-box">
                    <span class="stat-number">1.9B</span>
                    <span class="stat-label">Servings Daily</span>
                </div>
            </div>
        </div>
    </section>

    <section id="contact-section" class="main-section">
        <video autoplay muted loop playsinline id="product-video-bg">
            <source src="assets/Contact.mp4" type="video/mp4">
        </video>
        <div class="contact-container">
            <h2 class="animated-element fade-in-up">Connect With Us</h2>
            <p class="animated-element fade-in-up" style="transition-delay: 0.1s;">Find the latest news, updates, and
                more on our social media platforms.</p>

            <div class="social-accounts-grid">
                <div class="social-block animated-element fade-in-up" style="transition-delay: 0.3s;">
                    <h3><i class="fab fa-facebook-f"></i> Facebook</h3>
                    <p><a href="https://web.facebook.com/CocaColaPhilippines/?_rdc=1&_rdr#" target="_blank"
                            style="color: var(--text-dim);">@Coca-Cola</a></p>
                </div>
                <div class="social-block animated-element fade-in-up" style="transition-delay: 0.4s;">
                    <h3><i class="fab fa-twitter"></i> X (Twitter)</h3>
                    <p><a href="https://x.com/CocaColaPH" target="_blank"
                            style="color: var(--text-dim);">@CocaColaPH</a></p>
                </div>
                <div class="social-block animated-element fade-in-up" style="transition-delay: 0.5s;">
                    <h3><i class="fab fa-instagram"></i> Instagram</h3>
                    <p><a href="https://www.instagram.com/cocacolaph/" target="_blank"
                            style="color: var(--text-dim);">@cocacolaph</a></p>
                </div>
                <div class="social-block animated-element fade-in-up" style="transition-delay: 0.6s;">
                    <h3><i class="fab fa-youtube"></i> YouTube</h3>
                    <p><a href="https://www.youtube.com/@CocaColaPhilippinesOfficial" target="_blank"
                            style="color: var(--text-dim);">Coca-Cola Philippines</a></p>
                </div>
                <div class="social-block animated-element fade-in-up" style="transition-delay: 0.6s;">
                    <h3><i class="fas fa-envelope"></i> Email</h3>
                    <p><a href="mailto:phicommunications@coca-cola.com" target="_blank"
                            style="color: var(--text-dim);">phicommunications@coca-cola.com</a></p>
                </div>
                <div class="social-block animated-element fade-in-up" style="transition-delay: 0.7s;">
                    <h3><i class="fas fa-map-marker-alt"></i> Corporate HQ</h3>
                    <p>Atlanta, Georgia, USA</p>
                </div>
            </div>
        </div>
    </section>


    <div id="product-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-headline"
        aria-describedby="modal-description" aria-hidden="true">
        <div class="modal-content">
            <button class="close-btn" aria-label="Close modal">&times;</button>
            <div class="modal-header">
                <img id="modal-image" src="" alt="">
                <div>
                    <span style="font-size: 0.8em; letter-spacing: 2px; font-weight: 600;" id="modal-tag"></span>
                    <h2 id="modal-headline" style="color: var(--coke-red);">PRODUCT NAME</h2>
                </div>
            </div>
            <p id="modal-description" style="margin-bottom: 20px; line-height: 1.6; color: var(--text-light);"></p>
            <h3 style="color: white; margin-bottom: 15px;">Nutrition Facts (Per 12 fl oz)</h3>
            <ul id="modal-ingredients-list" class="modal-ingredients">
            </ul>
            <button id="final-drink-now-btn" class="enter-btn"
                style="margin-top: 25px; width: 100%; text-align: center;">Enjoy A Coca-Cola</button>
        </div>
    </div>


    <script>
        // --- PRODUCT DATA (No Change) ---
        const productData = [
            {
                name: "COCA-COLA ORIGINAL TASTE",
                headline: "THE CLASSIC REFRESHMENT",
                description: "The world's most popular and best-selling soft drink, enjoyed by billions globally since 1886. The classic taste that started it all.",
                imageSrc: "./assets/coke-classic.png",
                bgColor: "#AA0000",
                productTag: "THE ORIGINAL",
                keyIngredients: "Carbonated Water, High Fructose Corn Syrup, Caramel Color, Phosphoric Acid, Natural Flavors, Caffeine.",
                nutritionBreakdown: [
                    { name: "Calories", amount: "140", dailyValue: "-" },
                    { name: "Total Fat", amount: "0g", dailyValue: "0%" },
                    { name: "Sodium", amount: "40mg", dailyValue: "2%" },
                    { name: "Total Carbohydrates", amount: "39g", dailyValue: "14%" },
                    { name: "Total Sugars", amount: "39g", dailyValue: "78%" },
                    { name: "Caffeine", amount: "34mg", dailyValue: "-" }
                ]
            },
            {
                name: "COCA-COLA ZERO SUGAR",
                headline: "ZERO SUGAR. REAL TASTE.",
                description: "Coca-Cola Zero Sugar, or Coke Zero, is a sugar-free soft drink that tastes like the original but has zero sugar and zero calories.",
                imageSrc: "./assets/coke-zero.png",
                bgColor: "#333333",
                productTag: "COCA COLA ZERO",
                keyIngredients: "Carbonated Water, Caramel Color, Phosphoric Acid, Aspartame, Potassium Benzoate (to protect taste), Natural Flavors, Citric Acid, Caffeine.",
                nutritionBreakdown: [
                    { name: "Calories", amount: "0", dailyValue: "-" },
                    { name: "Total Fat", amount: "0g", dailyValue: "0%" },
                    { name: "Sodium", amount: "40mg", dailyValue: "2%" },
                    { name: "Total Carbohydrates", amount: "0g", dailyValue: "0%" },
                    { name: "Total Sugars", amount: "0g", dailyValue: "0%" },
                    { name: "Caffeine", amount: "34mg", dailyValue: "-" }
                ]
            },
            {
                name: "DIET COKE",
                headline: "CRISP AND LIGHT",
                description: "Diet Coke offers a light, crisp, zero-calorie refreshment with a flavor profile distinct from Coke Zero.",
                imageSrc: "./assets/coke-diet.png",
                bgColor: "#A0A0A0",
                productTag: "COCA-COLA LIGHT",
                keyIngredients: "Carbonated Water, Caramel Color, Aspartame, Phosphoric Acid, Potassium Benzoate (to protect taste), Natural Flavors, Citric Acid, Caffeine.",
                nutritionBreakdown: [
                    { name: "Calories", amount: "0", dailyValue: "-" },
                    { name: "Total Fat", amount: "0g", dailyValue: "0%" },
                    { name: "Sodium", amount: "40mg", dailyValue: "2%" },
                    { name: "Total Carbohydrates", amount: "0g", dailyValue: "0%" },
                    { name: "Total Sugars", amount: "0g", dailyValue: "0%" },
                    { name: "Caffeine", amount: "46mg", dailyValue: "-" }
                ]
            },
            {
                name: "COCA-COLA CHERRY",
                headline: "SWEET CHERRY BURST",
                description: "Coca-Cola with a classic hint of cherry flavor, offering a sweeter and fruitier take on the original.",
                imageSrc: "./assets/coke-cherry.png",
                bgColor: "#8B0000",
                productTag: "CLASSIC FLAVOR",
                keyIngredients: "Carbonated Water, High Fructose Corn Syrup, Caramel Color, Phosphoric Acid, Natural Flavors, Caffeine, Cherry Flavoring.",
                nutritionBreakdown: [
                    { name: "Calories", amount: "150", dailyValue: "-" },
                    { name: "Total Fat", amount: "0g", dailyValue: "0%" },
                    { name: "Sodium", amount: "30mg", dailyValue: "1%" },
                    { name: "Total Carbohydrates", amount: "42g", dailyValue: "15%" },
                    { name: "Total Sugars", amount: "42g", dailyValue: "84%" },
                    { name: "Caffeine", amount: "34mg", dailyValue: "-" }
                ]
            },
            {
                name: "COCA-COLA VANILLA",
                headline: "SMOOTH VANILLA INFUSION",
                description: "The satisfying taste of Coca-Cola mixed with smooth, rich vanilla flavor.",
                imageSrc: "./assets/coke-vanilla.png",
                bgColor: "#E9967A",
                productTag: "SWEET TREAT",
                keyIngredients: "Carbonated Water, High Fructose Corn Syrup, Caramel Color, Natural Flavors, Phosphoric Acid, Caffeine, Vanilla Extract.",
                nutritionBreakdown: [
                    { name: "Calories", amount: "140", dailyValue: "-" },
                    { name: "Total Fat", amount: "0g", dailyValue: "0%" },
                    { name: "Sodium", amount: "35mg", dailyValue: "2%" },
                    { name: "Total Carbohydrates", amount: "39g", dailyValue: "14%" },
                    { name: "Total Sugars", amount: "39g", dailyValue: "78%" },
                    { name: "Caffeine", amount: "34mg", dailyValue: "-" }
                ]
            },
            {
                name: "COCA-COLA CHERRY VANILLA",
                headline: "CHERRY MEETS VANILLA",
                description: "A delicious fusion of classic Coca-Cola, sweet cherry, and smooth, creamy vanilla.",
                imageSrc: "./assets/coke-cherry-vanilla.png",
                bgColor: "#6C005E",
                productTag: "DOUBLE FLAVOR",
                keyIngredients: "Carbonated Water, High Fructose Corn Syrup, Caramel Color, Phosphoric Acid, Natural Flavors, Cherry Juice Concentrate, Vanilla Extract, Caffeine.",
                nutritionBreakdown: [
                    { name: "Calories", amount: "150", dailyValue: "-" },
                    { name: "Total Fat", amount: "0g", dailyValue: "0%" },
                    { name: "Sodium", amount: "30mg", dailyValue: "1%" },
                    { name: "Total Carbohydrates", amount: "42g", dailyValue: "15%" },
                    { name: "Total Sugars", amount: "42g", dailyValue: "84%" },
                    { name: "Caffeine", amount: "34mg", dailyValue: "-" }
                ]
            },
            {
                name: "COCA-COLA ORANGE VANILLA",
                headline: "CREAMY CITRUS TWIST",
                description: "A delicious combination of crisp Coca-Cola taste with a smooth, sweet orange and vanilla flavor.",
                imageSrc: "./assets/coke-orange-vanilla.png",
                bgColor: "#FF7F00",
                productTag: "FLAVOR BLAST",
                keyIngredients: "Carbonated Water, High Fructose Corn Syrup, Caramel Color, Natural Flavors, Phosphoric Acid, Orange Juice Concentrate, Vanilla Extract, Caffeine.",
                nutritionBreakdown: [
                    { name: "Calories", amount: "140", dailyValue: "-" },
                    { name: "Total Fat", amount: "0g", dailyValue: "0%" },
                    { name: "Sodium", amount: "35mg", dailyValue: "2%" },
                    { name: "Total Carbohydrates", amount: "39g", dailyValue: "14%" },
                    { name: "Total Sugars", amount: "39g", dailyValue: "78%" },
                    { name: "Caffeine", amount: "34mg", dailyValue: "-" }
                ]
            },
            {
                name: "COCA-COLA WITH LEMON",
                headline: "TANGY LEMON ZEST",
                description: "A refreshing twist on the classic cola taste with a vibrant, zesty lemon flavor.",
                imageSrc: "./assets/coke-lemon.png",
                bgColor: "#FFD700",
                productTag: "CITRUS TWIST",
                keyIngredients: "Carbonated Water, High Fructose Corn Syrup, Caramel Color, Phosphoric Acid, Natural Flavors, Lemon Juice Concentrate, Caffeine.",
                nutritionBreakdown: [
                    { name: "Calories", amount: "140", dailyValue: "-" },
                    { name: "Total Fat", amount: "0g", dailyValue: "0%" },
                    { name: "Sodium", amount: "40mg", dailyValue: "2%" },
                    { name: "Total Carbohydrates", amount: "39g", dailyValue: "14%" },
                    { name: "Total Sugars", amount: "39g", dailyValue: "78%" },
                    { name: "Caffeine", amount: "34mg", dailyValue: "-" }
                ]
            },
            {
                name: "COCA-COLA WITH LIME",
                headline: "ZESTY LIME KICK",
                description: "A bright, refreshing citrus note added to the classic Coca-Cola formula for extra zing.",
                imageSrc: "./assets/coke-lime.png",
                bgColor: "#8BC34A",
                productTag: "CITRUS POP",
                keyIngredients: "Carbonated Water, High Fructose Corn Syrup, Caramel Color, Phosphoric Acid, Natural Flavors, Lime Juice Concentrate, Caffeine.",
                nutritionBreakdown: [
                    { name: "Calories", amount: "140", dailyValue: "-" },
                    { name: "Total Fat", amount: "0g", dailyValue: "0%" },
                    { name: "Sodium", amount: "40mg", dailyValue: "2%" },
                    { name: "Total Carbohydrates", amount: "39g", dailyValue: "14%" },
                    { name: "Total Sugars", amount: "39g", dailyValue: "78%" },
                    { name: "Caffeine", amount: "34mg", dailyValue: "-" }
                ]
            },
            {
                name: "COCA-COLA MANGO",
                headline: "EXOTIC MANGO FLAVOR",
                description: "A bold and fruity twist to the classic cola, combining the refreshing taste of Coca-Cola with sweet tropical mango.",
                imageSrc: "./assets/coke-mango.png",
                bgColor: "#FFB400",
                productTag: "TROPICAL COLA",
                keyIngredients: "Carbonated Water, High Fructose Corn Syrup, Caramel Color, Phosphoric Acid, Natural Flavors, Mango Juice Concentrate, Caffeine.",
                nutritionBreakdown: [
                    { name: "Calories", amount: "150", dailyValue: "-" },
                    { name: "Total Fat", amount: "0g", dailyValue: "0%" },
                    { name: "Sodium", amount: "30mg", dailyValue: "1%" },
                    { name: "Total Carbohydrates", amount: "42g", dailyValue: "15%" },
                    { name: "Total Sugars", amount: "42g", dailyValue: "84%" },
                    { name: "Caffeine", amount: "34mg", dailyValue: "-" }
                ]
            },
            {
                name: "COCA-COLA RASPBERRY LTD",
                headline: "BRIGHT BERRY LIMITED EDITION",
                description: "An exciting, limited-time twist of refreshing raspberry flavor blended perfectly with Coca-Cola.",
                imageSrc: "./assets/coke-raspberry.png",
                bgColor: "#DC143C",
                productTag: "LIMITED EDITION",
                keyIngredients: "Carbonated Water, High Fructose Corn Syrup, Caramel Color, Phosphoric Acid, Natural Flavors, Raspberry Juice Concentrate, Caffeine.",
                nutritionBreakdown: [
                    { name: "Calories", amount: "140", dailyValue: "-" },
                    { name: "Total Fat", amount: "0g", dailyValue: "0%" },
                    { name: "Sodium", amount: "40mg", dailyValue: "2%" },
                    { name: "Total Carbohydrates", amount: "39g", dailyValue: "14%" },
                    { name: "Total Sugars", amount: "39g", dailyValue: "78%" },
                    { name: "Caffeine", amount: "34mg", dailyValue: "-" }
                ]
            },
            {
                name: "COCA-COLA CITRA",
                headline: "LEMON-LIME REFRESHMENT",
                description: "A uniquely refreshing combination of Coca-Cola with a vibrant blend of lemon and lime citrus flavors.",
                imageSrc: "./assets/coke-citra.png",
                bgColor: "#4CAF50",
                productTag: "CITRUS BLAST",
                keyIngredients: "Carbonated Water, High Fructose Corn Syrup, Caramel Color, Phosphoric Acid, Natural Flavors, Lemon and Lime Juice Concentrates, Caffeine.",
                nutritionBreakdown: [
                    { name: "Calories", amount: "140", dailyValue: "-" },
                    { name: "Total Fat", amount: "0g", dailyValue: "0%" },
                    { name: "Sodium", amount: "40mg", dailyValue: "2%" },
                    { name: "Total Carbohydrates", amount: "39g", dailyValue: "14%" },
                    { name: "Total Sugars", amount: "39g", dailyValue: "78%" },
                    { name: "Caffeine", amount: "34mg", dailyValue: "-" }
                ]
            },
            {
                name: "CAFFEINE-FREE COCA-COLA",
                headline: "GREAT TASTE, NO CAFFEINE",
                description: "The classic Coca-Cola taste, but completely caffeine-free for any time of day.",
                imageSrc: "./assets/coke-caffine-free.png",
                bgColor: "#B53333",
                productTag: "CAFFEINE FREE",
                keyIngredients: "Carbonated Water, High Fructose Corn Syrup, Caramel Color, Phosphoric Acid, Natural Flavors.",
                nutritionBreakdown: [
                    { name: "Calories", amount: "140", dailyValue: "-" },
                    { name: "Total Fat", amount: "0g", dailyValue: "0%" },
                    { name: "Sodium", amount: "40mg", dailyValue: "2%" },
                    { name: "Total Carbohydrates", amount: "39g", dailyValue: "14%" },
                    { name: "Total Sugars", amount: "39g", dailyValue: "78%" },
                    { name: "Caffeine", amount: "0mg", dailyValue: "-" }
                ]
            }
        ];

        // --- GLOBAL VARIABLES (No Change) ---
        let currentIndex = 0;
        const totalSlides = productData.length;
        let autoSlideInterval;
        const scrollContainer = document.getElementById('hero-scroll-container');
        const slideshowContent = document.getElementById('slideshow-text-content');
        const modal = document.getElementById('product-modal');
        const closeModalBtn = modal.querySelector('.close-btn');
        let lastFocusedElement = null;
        const productSection = document.getElementById('product-section');

        // --- SOUND MANAGER (No Change) ---
        class SoundManager {
            constructor() {
                try {
                    this.ctx = new (window.AudioContext || window.webkitAudioContext)();
                    this.buffers = {};
                    this.started = false;
                } catch (e) {
                    console.warn("Audio not supported");
                }
            }

            async load(name, url) {
                if (!this.ctx) return;
                try {
                    const res = await fetch(url);
                    const buf = await res.arrayBuffer();
                    this.buffers[name] = await this.ctx.decodeAudioData(buf);
                } catch (error) {
                    console.error(`Error loading sound ${name}:`, error);
                }
            }

            play(name, loop = false, volume = 1.0) {
                if (!this.ctx || !this.buffers[name]) return;
                const source = this.ctx.createBufferSource();
                const gainNode = this.ctx.createGain();
                source.buffer = this.buffers[name];
                source.loop = loop;
                gainNode.gain.value = volume;
                source.connect(gainNode);
                gainNode.connect(this.ctx.destination);
                source.start(0);
                return source;
            }
        }
        const soundMgr = new SoundManager();

        // NEW: Grid View Variables
        const productGridContainer = document.createElement('div');
        productGridContainer.id = 'product-grid-view';
        productGridContainer.className = 'product-grid-view';
        let isGridViewActive = false; // Track the current view

        // NEW: Welcome Video Control Functions
        function startWelcomeVideoAndAudio(videoElement) {
            if (videoElement) {
                // Attempt to un-mute and play the video.
                videoElement.muted = false;
                videoElement.play().catch(e => {
                    // If play fails (e.g., audio context suspended), console log and re-mute to comply with browser rules
                    console.log('Welcome video play failed (browser policy or similar).', e);
                    videoElement.muted = true;
                });
            }
        }

        function stopWelcomeVideoAndAudio(videoElement) {
            if (videoElement) {
                // Mute the audio and pause the video, as requested
                videoElement.muted = true;
                videoElement.pause();
                // Reset to start for a fresh play when scrolling back
                videoElement.currentTime = 0;
            }
        }

        // --- CAROUSEL CONTROL FUNCTIONS (No Change) ---
        function stopAutoSlide() {
            clearInterval(autoSlideInterval);
            autoSlideInterval = null;
        }

        function startAutoSlide() {
            // Only start if it's not already running
            if (autoSlideInterval) return;
            autoSlideInterval = setInterval(() => {
                // Also check if modal is open or grid is open to pause auto-slide
                if (!document.getElementById('product-modal').classList.contains('open') && !isGridViewActive) {
                    let next = (currentIndex + 1) % totalSlides;
                    scrollToSlideIndex(next);
                }
            }, 6000);
        }

        function resetAutoSlide() {
            stopAutoSlide();
            startAutoSlide();
        }

        function updateSlide(index) {
            if (index === currentIndex) return;

            const data = productData[index];
            const isDesktop = window.innerWidth > 850;

            if (isDesktop) soundMgr.play('trans', false, 0.5);

            // 1. Animate Text Out
            slideshowContent.classList.remove('text-active', 'text-entering');
            slideshowContent.classList.add('text-leaving');

            // 2. Animate Image Out
            const oldImage = document.querySelector('.coke-image[data-index="' + currentIndex + '"]');
            if (oldImage) {
                oldImage.classList.add('image-leaving');
            }


            // Wait for animation to complete (400ms)
            setTimeout(() => {
                // 3. Update Content
                currentIndex = index;

                // Update Text Content
                document.getElementById('product-tag').innerText = data.productTag;
                document.getElementById('product-tag').style.color = data.bgColor;
                document.getElementById('headline').innerText = data.headline;
                document.getElementById('description').innerText = data.description;

                // Update Background Color (via the hero-content)
                const heroContent = document.getElementById('product-hero-content');
                heroContent.style.backgroundImage = `linear-gradient(to bottom, ${data.bgColor}, rgba(0, 0, 0, 0.4))`;


                // Reset all images to hidden and remove old leaving class
                document.querySelectorAll('.coke-image').forEach(img => {
                    img.style.opacity = '0';
                    img.classList.remove('image-leaving');
                });

                // Show new image
                const newImage = document.querySelector('.coke-image[data-index="' + index + '"]');
                if (newImage) {
                    newImage.style.opacity = '1';
                }

                // 4. Animate Text In
                slideshowContent.classList.remove('text-leaving');
                slideshowContent.classList.add('text-entering');
                setTimeout(() => {
                    slideshowContent.classList.remove('text-entering');
                    slideshowContent.classList.add('text-active');
                }, 100);

                // 5. Update Pagination
                document.getElementById('current-slide').innerText = (index + 1).toString().padStart(2, '0');
                document.getElementById('total-slides').innerText = totalSlides.toString().padStart(2, '0');
            }, 400); // Should match CSS transition speed for animations
        }

        function scrollToSlideIndex(index) {
            const slide = document.querySelector(`.slide[data-index="${index}"]`);
            if (slide) {
                // Smooth scroll the carousel container horizontally
                scrollContainer.scrollTo({
                    left: slide.offsetLeft,
                    behavior: 'smooth'
                });
                updateSlide(index);
                // No need to resetAutoSlide here as it's called by showNextSlide/showPrevSlide
            }
        }

        // NEW: Arrow Navigation Functions (Added by the AI)
        function showNextSlide() {
            let next = (currentIndex + 1) % totalSlides;
            scrollToSlideIndex(next);
            resetAutoSlide();
        }

        function showPrevSlide() {
            // Add totalSlides before modulo to ensure the result is positive when currentIndex is 0
            let prev = (currentIndex - 1 + totalSlides) % totalSlides;
            scrollToSlideIndex(prev);
            resetAutoSlide();
        }

        // --- MODAL FUNCTIONS (No Change) ---
        function openModal() {
            soundMgr.play('open');
            modal.classList.add('open');
            modal.setAttribute('aria-hidden', 'false');

            // A11Y: Store the element that was focused before opening the modal
            lastFocusedElement = document.activeElement;
            // Pause auto slide when modal is open
            stopAutoSlide();

            const d = productData[currentIndex];
            document.getElementById('modal-image').src = d.imageSrc;
            document.getElementById('modal-tag').innerText = d.productTag;
            document.getElementById('modal-headline').innerText = d.name;
            document.getElementById('modal-headline').style.color = d.bgColor;
            document.getElementById('modal-description').innerText = d.description;

            const list = document.getElementById('modal-ingredients-list');
            list.innerHTML = ''; // Clear previous content

            // 1. Add Key Ingredients section (Full width row)
            const ingredientsLi = document.createElement('li');
            // Inline styles to force stack layout and visual separation
            ingredientsLi.style.flexDirection = 'column';
            ingredientsLi.style.alignItems = 'flex-start';
            ingredientsLi.style.padding = '10px 0 15px 0';
            ingredientsLi.style.borderBottom = '1px solid rgba(255,255,255,0.2)'; // Solid line for separation
            ingredientsLi.innerHTML = `
                <span style="color:var(--coke-red); font-weight:700; margin-bottom: 5px; font-size:1em;">KEY INGREDIENTS:</span>
                <span style="color:var(--text-dim); font-size: 0.85em; line-height: 1.4;">${d.keyIngredients}</span>
            `;
            list.appendChild(ingredientsLi);


            // 2. Add Nutrition Facts Header (Table Header Row)
            const headerLi = document.createElement('li');
            headerLi.style.fontWeight = '700';
            headerLi.style.borderTop = '4px solid white'; // Thick top line
            headerLi.style.borderBottom = '2px solid white'; // Thicker bottom
            headerLi.style.color = 'white';
            headerLi.innerHTML = `
                <span>AMOUNT PER SERVING</span>
                <span>% DAILY VALUE</span>
            `;
            list.appendChild(headerLi);

            // 3. Add Nutrition Breakdown
            d.nutritionBreakdown.forEach(item => {
                const li = document.createElement('li');
                // Highlight Calories and Caffeine
                if (item.name === 'Calories' || item.name === 'Caffeine') {
                    li.style.color = 'white';
                    li.style.fontWeight = '700';
                }
                li.innerHTML = `
                    <span>${item.name}: <strong>${item.amount}</strong></span>
                    <span>${item.dailyValue}</span>
                `;
                list.appendChild(li);
            });
        }

        function closeModal() {
            modal.classList.remove('open');
            modal.setAttribute('aria-hidden', 'true');
            soundMgr.play('close');
            // A11Y: Return focus to the element that was focused before opening the modal
            if (lastFocusedElement) {
                lastFocusedElement.focus();
            }
            // Resume auto slide only if we are on the product section and grid view is not active
            if (document.location.hash === '#product-section' && !isGridViewActive) {
                startAutoSlide();
            }
        }

        // --- PRODUCT GRID FUNCTIONS (No Change) ---
        function buildProductGrid() {
            productData.forEach((d, i) => {
                const card = document.createElement('div');
                card.className = 'grid-product-card';
                card.innerHTML = `
                    <span class="grid-product-tag" style="color: ${d.bgColor};">${d.productTag}</span>
                    <img src="${d.imageSrc}" alt="${d.name}">
                    <h4>${d.name.replace('COCA-COLA ', '')}</h4>
                `;
                // MODIFIED: Add event listener to switch to the specific slide
                card.addEventListener('click', (e) => {
                    if (e.target.tagName !== 'A') {
                        e.preventDefault();
                        // 1. Set the current index to the selected product
                        currentIndex = i;
                        // 2. If the grid view is active, switch back to the slideshow view
                        if (isGridViewActive) {
                            toggleProductView();
                        }
                        // 3. Scroll the main product carousel to the selected slide
                        scrollToSlideIndex(i);
                    }
                });
                productGridContainer.appendChild(card);
            });
            document.getElementById('product-hero-content').appendChild(productGridContainer);
        }

        function toggleProductView() {
            const toggleBtn = document.getElementById('toggle-view-btn');
            isGridViewActive = !isGridViewActive;
            if (isGridViewActive) {
                // Switch to Grid View
                productGridContainer.classList.add('active');
                slideshowContent.classList.add('inactive'); // Hide slideshow text
                productSection.classList.add('grid-active'); // Set class on section for background dimming
                toggleBtn.innerText = "Back to Slideshow";
                stopAutoSlide(); // Important: Stop slideshow when grid is open
            } else {
                // Switch back to Slideshow View
                productGridContainer.classList.remove('active');
                slideshowContent.classList.remove('inactive'); // Show slideshow text
                productSection.classList.remove('grid-active'); // Remove class to restore background
                toggleBtn.innerText = "View All Products";
                startAutoSlide(); // Resume slideshow
            }
            soundMgr.play('click');
        }

        // --- SECTION ANIMATION LOGIC (Scroll Reveal - No Change) ---
        function setupSectionAnimations(sectionId) {
            // REFACTORED to be generic
            const section = document.getElementById(sectionId);
            if (!section) return;

            const elementsToAnimate = section.querySelectorAll('.animated-element');

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        elementsToAnimate.forEach(el => {
                            el.classList.add('animate-ready');
                        });
                        observer.unobserve(section); // Stop observing after animation
                    }
                });
            }, {
                root: null,
                rootMargin: '0px',
                threshold: 0.3
            });

            observer.observe(section);
        }

        // --- SECTION TRANSITION LOGIC (No Change) ---
        function transitionToSection(targetSelector) {
            const overlay = document.getElementById('transition-overlay');
            overlay.classList.add('is-transitioning');
            // Play sound
            soundMgr.play('trans', false, 0.8);

            // Navigate after half of the transition animation (400ms)
            setTimeout(() => {
                document.querySelector(targetSelector).scrollIntoView({
                    behavior: 'smooth'
                });
            }, 400);

            // Wipe Out (800ms)
            setTimeout(() => {
                overlay.classList.remove('is-transitioning');
                // If navigating to the product section AND grid is NOT active, start the auto slide here
                if (targetSelector === '#product-section' && !isGridViewActive) {
                    startAutoSlide();
                }
            }, 800);
        }


        // MODIFIED: Function to handle initial user interaction for sound.
        function startAudio() {
            if (soundMgr.ctx && soundMgr.ctx.state === 'suspended') {
                soundMgr.ctx.resume();
            }
            // MODIFICATION: Unmute and play the welcome video on first interaction if on welcome section
            const welcomeVideo = document.getElementById('welcome-video');
            // Check if we are on the welcome section (or initial load before scrolling) and the video exists
            if ((document.location.hash === '' || document.location.hash === '#welcome-section') && welcomeVideo) {
                welcomeVideo.muted = false; // Allow audio after first interaction
                // Attempt to play (browser will allow since it's user-initiated)
                welcomeVideo.play().catch(e => {
                    console.log('Welcome Video resume failed on interaction:', e);
                    welcomeVideo.muted = true; // Re-mute if play fails
                });
            }
        }


        // --- SCROLL SNAP INTERSECTION OBSERVER LOGIC (MODIFIED to include welcome video control) ---
        function setupScrollTransitionObserver(welcomeVideo) {
            const sections = document.querySelectorAll('.main-section');
            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.6
            };
            let lastSectionIndex = 0; // Track last section for transition logic
            const scrollObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const currentSectionId = '#' + entry.target.id;
                        const currentSectionIndex = Array.from(sections).indexOf(entry.target);

                        // NEW: WELCOME SECTION VIDEO/AUDIO AUTOPLAY/STOP LOGIC
                        if (currentSectionId === '#welcome-section') {
                            startWelcomeVideoAndAudio(welcomeVideo);
                        } else {
                            stopWelcomeVideoAndAudio(welcomeVideo);
                        }

                        // PRODUCT SLIDESHOW AUTOPLAY LOGIC
                        if (currentSectionId === '#product-section' && !isGridViewActive) {
                            startAutoSlide();
                        } else {
                            stopAutoSlide();
                        }

                        // TRANSITION LOGIC
                        // Only apply transition if moving to a *different* and *adjacent* section
                        if (currentSectionIndex !== lastSectionIndex && Math.abs(currentSectionIndex - lastSectionIndex) === 1) {
                            // Immediately apply the wipe transition
                            const overlay = document.getElementById('transition-overlay');
                            overlay.classList.add('is-transitioning');
                            // Play sound
                            soundMgr.play('trans', false, 0.8);

                            // The transition animation takes 0.8s. We remove the class after it completes
                            setTimeout(() => {
                                overlay.classList.remove('is-transitioning');
                            }, 800);
                        }

                        // Update active navigation link
                        document.querySelectorAll('.nav-links a').forEach(a => {
                            a.classList.remove('active');
                            if (a.getAttribute('href') === currentSectionId) {
                                a.classList.add('active');
                            }
                        });

                        lastSectionIndex = currentSectionIndex;
                    }
                });
            }, observerOptions);

            sections.forEach(section => {
                scrollObserver.observe(section);
            });
        }


        // --- CUSTOM CURSOR LOGIC (No Change) ---
        function setupCustomCursor() {
            const cursor = document.getElementById('custom-cursor');
            if (cursor) {
                document.addEventListener('mousemove', e => {
                    cursor.style.left = e.clientX + 'px';
                    cursor.style.top = e.clientY + 'px';
                });
                // Updated selector to include .grid-product-card
                document.querySelectorAll('a, button, .slide, .stat-box, .close-btn, .grid-product-card, .social-block').forEach(el => {
                    el.addEventListener('mouseenter', () => cursor.classList.add('grow'));
                    el.addEventListener('mouseleave', () => cursor.classList.remove('grow'));
                });
            }
        }


        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', async () => {

            document.body.classList.add('loaded'); // Fade in the body once everything is loaded

            // Load Sounds (Paths assumed from original upload)
            const p1 = soundMgr.load('bg', 'assets/Coke - Open happiness sound.mp3');
            const p2 = soundMgr.load('trans', 'assets/Coke - Can open sound.mp3');
            const p3 = soundMgr.load('open', 'assets/Coke - Refreshing sound.mp3');
            const p4 = soundMgr.load('close', 'assets/Coke - Bubbles sound.mp3');
            const p5 = soundMgr.load('click', 'assets/Coke - Glass clink sound.mp3');

            await Promise.all([p1, p2, p3, p4, p5]);


            // 1. Build Carousel Slides (No Change)
            const carouselInner = document.getElementById('carousel-inner');
            productData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'slide';
                slide.setAttribute('data-index', index);
                slide.innerHTML = `
                    <div class="product-visual">
                        <img src="${data.imageSrc}" alt="${data.name}" class="coke-image" data-index="${index}" style="opacity: ${index === 0 ? 1 : 0};">
                    </div>
                `;
                carouselInner.appendChild(slide);
            });

            // Set initial state for pagination
            document.getElementById('current-slide').innerText = '01';
            document.getElementById('total-slides').innerText = totalSlides.toString().padStart(2, '0');

            // 2. Setup Arrow Navigation Listeners (No Change)
            document.getElementById('prev-btn').addEventListener('click', showPrevSlide);
            document.getElementById('next-btn').addEventListener('click', showNextSlide);

            // 3. Start Background Audio on First User Interaction (No Change)
            document.addEventListener('click', startAudio, {
                once: true
            });
            document.addEventListener('keydown', startAudio, {
                once: true
            });

            // Build Product Grid
            buildProductGrid();

            // Setup Custom Cursor
            setupCustomCursor();

            // NEW: Get reference to the welcome video element
            const welcomeVideo = document.getElementById('welcome-video');

            // Setup Observers
            setupSectionAnimations('about-section');
            setupSectionAnimations('contact-section');
            // MODIFIED: Pass the welcomeVideo element to the observer setup
            setupScrollTransitionObserver(welcomeVideo);

            // 1. Initial State for Slideshow
            if (document.location.hash === '#product-section') {
                startAutoSlide();
            }

            // 2. Toggle View Listener
            document.getElementById('toggle-view-btn').addEventListener('click', toggleProductView);

            // 3. Modal Listeners
            document.getElementById('drink-now-btn').addEventListener('click', (e) => {
                e.preventDefault();
                openModal(e);
            });
            closeModalBtn.addEventListener('click', closeModal);
            document.getElementById('final-drink-now-btn').addEventListener('click', () => {
                soundMgr.play('open');
                closeModal();
            });

            // A11Y: Close modal on ESC key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && modal.classList.contains('open')) {
                    closeModal();
                }
            });

            // 5. Section Transition for Nav and Experience Button (No Change)
            document.querySelectorAll('a[href^="#"], #start-experience-btn').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = this.getAttribute('href');

                    // Only apply wipe transition to main vertical sections
                    if (['#welcome-section', '#product-section', '#about-section', '#contact-section'].includes(target)) {
                        transitionToSection(target);
                    } else {
                        document.querySelector(target).scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                });
            });

        });
    </script>
</body>

</html>


